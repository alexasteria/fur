(this.webpackJsonpfur=this.webpackJsonpfur||[]).push([[0],{169:function(e,t,n){e.exports=n(262)},261:function(e,t,n){e.exports=n.p+"static/media/circle.f55eff56.png"},262:function(e,t,n){"use strict";n.r(t);n(170),n(196),n(198),n(199),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(210),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(235),n(236),n(237),n(238);var a=n(0),o=n.n(a),r=n(48),l=n.n(r),c=n(32),s=n.n(c),i=n(22),u=n(3),d=(n(102),n(111)),m=n.n(d),h=n(112),p=n.n(h),g=n(49),f=n(50),E=n(55),b=n(54),v=n(264),k=n(266),y=n(265),z=n(263),j=(n(103),function(e){Object(E.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(g.a)(this,a),(n=t.call(this,e)).state={lat:55.75396,long:37.620393,zoom:12},n}return Object(f.a)(a,[{key:"componentDidMount",value:function(){0!==this.props.coords.lat&&this.setState({lat:this.props.coords.lat,long:this.props.coords.long,zoom:this.props.coords.zoom})}},{key:"render",value:function(){var e=n(21),t=e.icon({iconUrl:n(70),iconSize:[64,55],iconAnchor:[32,64],popupAnchor:null,shadowUrl:null,shadowSize:null,shadowAnchor:null});e.icon({iconUrl:n(71),iconSize:[64,55],iconAnchor:[32,64],popupAnchor:null,shadowUrl:null,shadowSize:null,shadowAnchor:null});return o.a.createElement("div",{style:{height:"100%",width:"100%",scroll:"noscroll"}},o.a.createElement(v.a,{zoomControl:!1,style:{height:"100%",width:"100%",position:"absolute",zIndex:1},zoom:this.state.zoom,center:[0!==this.props.coords.lat?this.props.coords.lat:this.state.lat,0!==this.props.coords.long?this.props.coords.long:this.state.long]},o.a.createElement(k.a,{url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),o.a.createElement(y.a,{center:[0!==this.props.coords.lat?this.props.coords.lat:this.state.lat,0!==this.props.coords.long?this.props.coords.long:this.state.long]}),o.a.createElement(z.a,{onClick:this.props.openModalCard,icon:t,position:[56.237361899999996,43.4565182]})))}}]),a}(o.a.Component)),S=(n(259),n(56)),w=n.n(S),C=n(267),O=function(e){Object(E.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(g.a)(this,a),(n=t.call(this,e)).addMarker=function(e,t){var a=e.latlng;console.log(a);var r=n.getDistanceFromLatLonInKm(n.state.lat,n.state.long,a.lat,a.lng);console.log(r),r<1?(n.setState({marker:a}),t&&t.leafletElement&&t.leafletElement.openPopup()):(n.setState({marker:null}),n.props.snackbar(o.a.createElement(u.v,{onClose:function(){return n.props.snackbar(null)}},"\u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043e\u0442 \u0412\u0430\u0441 \u0434\u043e \u0442\u043e\u0447\u043a\u0438 \u0431\u043e\u043b\u0435\u0435 1 \u043a\u0438\u043b\u043e\u043c\u0435\u0442\u0440\u0430. \u041d\u0435\u043b\u044c\u0437\u044f \u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0447\u043a\u0438 \u0442\u0430\u043a \u0434\u0430\u043b\u0435\u043a\u043e.")))},n.state={lat:55.75396,long:37.620393,zoom:12,marker:null},n}return Object(f.a)(a,[{key:"componentDidMount",value:function(){0!==this.props.coords.lat&&this.setState({lat:this.props.coords.lat,long:this.props.coords.long,zoom:this.props.coords.zoom})}},{key:"getDistanceFromLatLonInKm",value:function(e,t,n,a){var o=this.deg2rad(n-e),r=this.deg2rad(a-t),l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(this.deg2rad(e))*Math.cos(this.deg2rad(n))*Math.sin(r/2)*Math.sin(r/2);return 6371*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))}},{key:"deg2rad",value:function(e){return e*(Math.PI/180)}},{key:"render",value:function(){var e=n(21),t=e.icon({iconUrl:n(70),iconSize:[64,55],iconAnchor:[32,64],popupAnchor:null,shadowUrl:null,shadowSize:null,shadowAnchor:null}),a=e.icon({iconUrl:n(71),iconSize:[64,55],iconAnchor:[32,64],popupAnchor:null,shadowUrl:null,shadowSize:null,shadowAnchor:null});return o.a.createElement("div",{style:{height:"200px",width:"100%",scroll:"noscroll"}},o.a.createElement(v.a,{zoomControl:!1,onClick:this.addMarker,style:{height:"200px",width:"100%",position:"absolute"},zoom:this.state.zoom,center:[this.state.lat,this.state.long]},o.a.createElement(k.a,{url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),o.a.createElement(y.a,{center:[0!==this.props.coords.lat?this.props.coords.lat:this.state.lat,0!==this.props.coords.long?this.props.coords.long:this.state.long]}),null!==this.state.marker&&o.a.createElement(z.a,{icon:"dps"===this.props.type?t:a,position:this.state.marker},o.a.createElement(C.a,{permanent:!0},o.a.createElement("span",null,"\u0417\u0434\u0435\u0441\u044c")))))}}]),a}(o.a.Component),x=(n(260),function(e){var t=Object(a.useState)(null),n=Object(i.a)(t,2),r=n[0],l=n[1],c=Object(a.useState)(null),s=Object(i.a)(c,2),d=s[0],m=s[1],h=Object(a.useState)(null),p=Object(i.a)(h,2),g=p[0],f=p[1],E=Object(a.useState)(null),b=Object(i.a)(E,2),v=b[0],k=b[1];function y(e){var t=e.target.files[0];t.type.match("image.*")||console.log("Image only please....");var n=new FileReader;n.onload=function(e){null===r?l("url("+e.target.result+")"):null===d?m("url("+e.target.result+")"):null===g&&f("url("+e.target.result+")")},n.readAsDataURL(t)}return o.a.createElement(o.a.Fragment,null,o.a.createElement(u.k,{header:o.a.createElement(u.l,{mode:"secondary"},"\u0421\u0434\u0435\u043b\u0430\u0439\u0442\u0435 \u043e\u0442\u043c\u0435\u0442\u043a\u0443 \u043d\u0430 \u043a\u0430\u0440\u0442\u0435")},o.a.createElement(O,{type:v,snackbar:e.snackbar,coords:e.coords,height:"400px"})),o.a.createElement(u.k,{separator:"hide",header:o.a.createElement(u.l,{mode:"secondary"},"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438")},o.a.createElement(u.d,null,o.a.createElement(u.c,{size:"s",mode:"shadow"},o.a.createElement("div",{style:{height:96,backgroundPosition:"center",backgroundSize:"cover",backgroundImage:r}},null===r&&o.a.createElement(u.i,{onChange:function(e){return y(e)},style:{height:"100%",width:"100%",backgroundColor:"#00ffff00"},top:"",controlSize:"xl"},o.a.createElement(w.a,{style:{marginTop:"19px",color:"#9ec1ea"}}))),null!==r&&o.a.createElement("div",{style:{color:"red",textAlign:"center"},onClick:function(){return l(null)}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")),o.a.createElement(u.c,{size:"s",mode:"shadow"},o.a.createElement("div",{style:{height:96,backgroundPosition:"center",backgroundSize:"cover",backgroundImage:d}},null===d&&o.a.createElement(u.i,{onChange:function(e){return y(e)},style:{height:"100%",width:"100%",backgroundColor:"#00ffff00"},top:"",controlSize:"xl"},o.a.createElement(w.a,{style:{marginTop:"19px",color:"#9ec1ea"}}))),null!==d&&o.a.createElement("div",{style:{color:"red",textAlign:"center"},onClick:function(){return m(null)}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")),o.a.createElement(u.c,{size:"s",mode:"shadow"},o.a.createElement("div",{style:{height:96,backgroundPosition:"center",backgroundSize:"cover",backgroundImage:g}},null===g&&o.a.createElement(u.i,{onChange:function(e){return y(e)},style:{height:"100%",width:"100%",backgroundColor:"#00ffff00"},top:"",controlSize:"xl"},o.a.createElement(w.a,{style:{marginTop:"19px",color:"#9ec1ea"}}))),null!==g&&o.a.createElement("div",{style:{color:"red",textAlign:"center"},onClick:function(){return f(null)}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")))),o.a.createElement(u.k,{header:o.a.createElement(u.l,{mode:"secondary"},"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0442\u0438\u043f \u043e\u0442\u043c\u0435\u0442\u043a\u0438")},o.a.createElement(u.j,null,o.a.createElement("div",null,o.a.createElement(u.t,{onClick:function(){return k("cam")},name:"radio",value:"cam",description:"\u0422\u0440\u0435\u043d\u043e\u0433\u0430",defaultChecked:!0},"\u041f\u0435\u0440\u0435\u0434\u0432\u0438\u0436\u043d\u0430\u044f \u043a\u0430\u043c\u0435\u0440\u0430"),o.a.createElement(u.t,{onClick:function(){return k("dps")},name:"radio",value:"dps",description:"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0438 \u0441\u043f\u0435\u0446\u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438"},"\u041c\u043e\u0431\u0438\u043b\u044c\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430 \u0414\u041f\u0421")))),o.a.createElement(u.k,{header:o.a.createElement(u.l,{mode:"secondary"},"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435")},o.a.createElement(u.b,{size:"xl",mode:"secondary"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u0430 \u043a\u0430\u0440\u0442\u0443")))}),_=n(115),A=n.n(_),M=n(74),I=n.n(M),P=function(e){var t=e.geoStatus,r=e.setGeoStatus,l=e.coords,c=Object(a.useState)({zero:!0,one:!0,two:!0,three:!0,four:!0}),s=Object(i.a)(c,2),d=s[0],m=s[1],h=Object(a.useState)(!1),p=Object(i.a)(h,2),g=p[0],f=p[1],E=n(70),b=n(71),v=n(261);return o.a.createElement(u.p,{id:"map"},o.a.createElement(u.q,{left:o.a.createElement(u.r,{onClick:function(){return f(!g)}},o.a.createElement(A.a,{style:{transform:"rotate(".concat(g?"180deg":"0",")")},onClick:function(){return f(!g)}}))},"\u041a\u0430\u0440\u0442\u0430"),o.a.createElement(u.s,{style:{zIndex:10},opened:g,onClose:function(){return f(!g)}},o.a.createElement(u.m,null,o.a.createElement(u.e,{before:o.a.createElement("img",{style:{height:45,padding:"0 10px 0 10px"},src:v})},"\u0412\u044b \u0437\u0434\u0435\u0441\u044c"),o.a.createElement(u.e,{description:"\u0422\u0440\u0435\u043d\u043e\u0433\u0438",before:o.a.createElement("img",{style:{height:45,padding:"0 17px 0 17px"},src:b}),asideContent:!0===d.two?o.a.createElement(I.a,{fill:"var(--accent)"}):null,onClick:function(){var e=d;e.two=!d.two,m(e)}},"\u041f\u0435\u0440\u0435\u0434\u0432\u0438\u0436\u043d\u044b\u0435 \u043a\u0430\u043c\u0435\u0440\u044b"),o.a.createElement(u.e,{description:"\u0414\u0435\u0436\u0443\u0440\u043d\u044b\u0435 \u044d\u043a\u0438\u043f\u0430\u0436\u0438",before:o.a.createElement("img",{style:{height:45},src:E}),asideContent:!0===d.three?o.a.createElement(I.a,{fill:"var(--accent)"}):null,onClick:function(){var e=d;e.three=!d.three,m(e)}},"\u041c\u043e\u0431\u0438\u043b\u044c\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430 \u0414\u041f\u0421"))),!1===t&&o.a.createElement(u.e,{style:{zIndex:5},onClick:function(){return r(null)},multiline:!0},"\u0412\u044b \u043d\u0435 \u0434\u0430\u043b\u0438 \u0434\u043e\u0441\u0442\u0443\u043f \u0432 \u0433\u0435\u043e\u043f\u043e\u0437\u0438\u0446\u0438\u0438, \u0434\u043b\u044f \u0431\u043e\u043b\u0435\u0435 \u0443\u0434\u043e\u0431\u043d\u043e\u0439 \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u0441\u044e\u0434\u0430"),o.a.createElement(j,{coords:l,openModalCard:e.openModalCard}))},U=function(e){var t=e.setModalPage,n=Object(a.useState)("info"),r=Object(i.a)(n,2),l=r[0];r[1];return Object(a.useEffect)((function(){console.log(l)})),o.a.createElement(o.a.Fragment,null,o.a.createElement(u.g,null,"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u043e\u0442\u043c\u0435\u0442\u043a\u0430:"),o.a.createElement(u.u,{before:o.a.createElement(u.a,{size:48,src:"https://sun1-19.userapi.com/icUGHkpxSwBNk4bwJSeVnoEEGC_iGmLBAryD1w/DH9wm4lg9mU.jpg"}),caption:"7 \u043c\u0438\u043d\u0443\u0442 \u043d\u0430\u0437\u0430\u0434",after:"+1"},"\u0412\u0430\u0441\u0438\u043b\u0438\u0439 \u041b\u0438\u0441\u043e\u0432\u0441\u043a\u0438\u0439"),o.a.createElement(u.d,null,o.a.createElement(u.c,{size:"s",mode:"shadow"},o.a.createElement("div",{style:{height:96,backgroundPosition:"center",backgroundSize:"cover",backgroundImage:'url("https://ib.drivenn.ru/bvpysv355088z_oc1hsy.jpeg")'}})),o.a.createElement(u.c,{size:"s",mode:"shadow"},o.a.createElement("div",{style:{height:96,backgroundPosition:"center",backgroundSize:"cover",backgroundImage:'url("https://ib.drivenn.ru/bvpysv355088z_oc1hsy.jpeg")'}})),o.a.createElement(u.c,{size:"s",mode:"shadow"},o.a.createElement("div",{style:{height:96,backgroundPosition:"center",backgroundSize:"cover",backgroundImage:'url("https://ib.drivenn.ru/bvpysv355088z_oc1hsy.jpeg")'}}))),o.a.createElement(u.g,{style:{display:"flex"}},o.a.createElement(u.b,{size:"l",stretched:!0,mode:"primary",style:{marginRight:8},onClick:function(){console.log(1),t(null)},after:o.a.createElement(u.f,null,"0")},"\u041d\u0430 \u043c\u0435\u0441\u0442\u0435"),o.a.createElement(u.b,{size:"l",stretched:!0,mode:"secondary",onClick:function(){console.log(2),t(null)},after:o.a.createElement(u.f,null,"0")},"\u0423\u0435\u0445\u0430\u043b\u0438")))},G=n(116),D=n.n(G),q=function(e){fetch("http://localhost:3030/users/auth",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))},L=function(e){var t=Object(a.useState)(null),n=Object(i.a)(t,2),r=n[0],l=n[1];Object(a.useEffect)((function(){if(void 0!==e.launchParams.sign)l(e.launchParams),console.log("\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043f\u0440\u0438\u0448\u043b\u0438"),q(e.launchParams);else{console.log("\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043d\u0435 \u043f\u0440\u0438\u0448\u043b\u0438");var t={vk_user_id:"199500866",vk_ref:"other",vk_platform:"mobile_web",vk_language:"ru",vk_is_favorite:"0",vk_is_app_user:"1",vk_are_notifications_enabled:"0",vk_app_id:"7538246",vk_access_token_settings:"notify",sign:"f8_2b177I52XCPrzq4WyrkHBJ6tAoQeGmaWtVxbsEZI"};l(t),q(t)}}),[]);var c=Object(a.useState)(null),d=Object(i.a)(c,2),h=d[0],g=d[1];null===h&&s.a.send("VKWebAppGetGeodata",{}).then((function(e){console.log(e),"User denied"===e.error_reason?g(!1):(g(!0),setInterval(f,1e4),k({lat:e.lat,long:e.long,zoom:13}))})).catch((function(e){return console.log(e)}));var f=function(){s.a.send("VKWebAppGetGeodata",{}).then((function(e){console.log(e),"User denied"===e.error_reason?g(!1):(g(!0),k({lat:e.lat,long:e.long,zoom:13}))})).catch((function(e){return console.log(e)}))},E=Object(a.useState)({lat:0,long:0}),b=Object(i.a)(E,2),v=b[0],k=b[1],y=Object(a.useState)(null),z=Object(i.a)(y,2),j=z[0],S=z[1],w=Object(a.useState)("map"),C=Object(i.a)(w,2),O=C[0],_=C[1],A=Object(a.useState)(null),M=Object(i.a)(A,2),I=M[0],G=M[1],L=o.a.createElement(u.o,{activeModal:"marker",style:{maxHeight:"500px",overflow:"scroll"}},o.a.createElement(u.n,{id:"marker",onClose:function(){return S(null)},header:"\u041c\u043e\u0431\u0438\u043b\u044c\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430 \u0414\u041f\u0421",caption:o.a.createElement(U,{setModalPage:S})}));return null===r?o.a.createElement("div",null,"no launch params"):o.a.createElement(u.h,{activeStory:O,tabbar:o.a.createElement(u.w,null,o.a.createElement(u.x,{onClick:function(){return _("map")},selected:"map"===O,"data-story":"map",text:"\u041a\u0430\u0440\u0442\u0430"},o.a.createElement(m.a,null)),o.a.createElement(u.x,{onClick:function(){return _("add")},selected:"add"===O,"data-story":"add",text:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"},o.a.createElement(p.a,null)),o.a.createElement(u.x,{onClick:function(){return _("chat")},selected:"chat"===O,"data-story":"chat",text:"\u0427\u0430\u0442\u0438\u043a"},o.a.createElement(D.a,null)))},o.a.createElement(u.y,{id:"map",activePanel:"map",modal:j},o.a.createElement(P,{id:"map",coords:v,geoStatus:h,setGeoStatus:g,openModalCard:function(){return S(L)}})),o.a.createElement(u.y,{id:"add",activePanel:"add"},o.a.createElement(u.p,{id:"add"},o.a.createElement(u.q,null,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),o.a.createElement(x,{coords:v,snackbar:function(e){return G(e)}}),I)),o.a.createElement(u.y,{id:"chat",activePanel:"chat"},o.a.createElement(u.p,{id:"chat"},o.a.createElement(u.q,null,"\u0427\u0430\u0442\u0438\u043a"))))};s.a.send("VKWebAppInit",{});var F=window.location.search.replace("?","").split("&").reduce((function(e,t){var n=t.split("=");return e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]),e}),{});l.a.render(o.a.createElement(L,{launchParams:F}),document.getElementById("root"))},70:function(e,t,n){e.exports=n.p+"static/media/dps.24d8e3ce.png"},71:function(e,t,n){e.exports=n.p+"static/media/cam.57bb3ebd.png"}},[[169,1,2]]]);
//# sourceMappingURL=main.5efc1161.chunk.js.map