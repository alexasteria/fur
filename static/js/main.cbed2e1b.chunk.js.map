{"version":3,"sources":["components/dps.png","components/map.js","components/minimap.js","components/add.js","panels/panelMap.js","components/markerInfo.js","App.js","index.js"],"names":["module","exports","MapComponent","props","state","lat","long","zoom","this","coords","setState","myIcon","require","icon","iconUrl","iconSize","iconAnchor","popupAnchor","shadowUrl","shadowSize","shadowAnchor","style","height","width","scroll","Map","zoomControl","position","zIndex","center","TileLayer","url","CircleMarker","Marker","onClick","openModalCard","React","Component","MiniMapComponent","addMarker","e","marker","newMarker","latlng","console","log","dist","getDistanceFromLatLonInKm","lng","leafletElement","openPopup","snackbar","onClose","lat1","lon1","lat2","lon2","dLat","deg2rad","dLon","a","Math","sin","cos","atan2","sqrt","deg","PI","Tooltip","permanent","Add","useState","photo1","setPhoto1","photo2","setPhoto2","photo3","setPhoto3","handleFileSelect","evt","f","target","files","type","match","reader","FileReader","onload","result","readAsDataURL","Fragment","header","mode","separator","size","backgroundPosition","backgroundSize","backgroundImage","onChange","event","backgroundColor","top","controlSize","marginTop","color","textAlign","name","value","description","defaultChecked","PanelMap","geoStatus","setGeoStatus","zero","one","two","three","four","filter","setFilter","support","openSupport","id","left","transform","opened","before","asideContent","fill","newFilter","multiline","MarkerInfo","setModalPage","activeTab","useEffect","src","caption","after","display","stretched","marginRight","App","bridge","send","then","res","error_reason","setCoords","catch","modalPage","activeStory","setActiveStory","setSnackbar","modalCard","activeModal","maxHeight","overflow","tabbar","selected","data-story","text","activePanel","modal","content","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.cbed2e1b.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/dps.24d8e3ce.png\";","import React, { Component } from 'react';\r\nimport {Map, CircleMarker, TileLayer, Marker, Popup} from \"react-leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport {\r\n    Button\r\n} from '@vkontakte/vkui';\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\n\r\nclass MapComponent extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            lat: 55.753960,\r\n            long: 37.620393,\r\n            zoom: 12\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.coords.lat !== 0){\r\n            this.setState({lat: this.props.coords.lat, long: this.props.coords.long, zoom: this.props.coords.zoom})\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const L = require('leaflet');\r\n\r\n        const myIcon = L.icon({\r\n            iconUrl: require('./dps.png'),\r\n            iconSize: [64,55],\r\n            iconAnchor: [32, 64],\r\n            popupAnchor: null,\r\n            shadowUrl: null,\r\n            shadowSize: null,\r\n            shadowAnchor: null\r\n        });\r\n            return (\r\n                <div style={{ height: \"100%\", width: \"100%\", scroll: \"noscroll\"}}>\r\n                    <Map\r\n                        zoomControl={false}\r\n                        style={{ height: \"100%\", width: \"100%\", position: 'absolute', zIndex: 1}}\r\n                        zoom={this.state.zoom}\r\n                        center={[this.props.coords.lat !== 0 ? this.props.coords.lat : this.state.lat, this.props.coords.long !==0 ? this.props.coords.long : this.state.long]}>\r\n                        <TileLayer url=\"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\" />\r\n                        <CircleMarker\r\n                            center={[this.props.coords.lat !== 0 ? this.props.coords.lat : this.state.lat, this.props.coords.long !==0 ? this.props.coords.long : this.state.long]}\r\n                        />\r\n                        <Marker\r\n                            onClick={this.props.openModalCard}\r\n                            icon={myIcon}\r\n                            position={[56.237361899999996,43.4565182]}\r\n                        />\r\n                    </Map>\r\n                </div>\r\n            );\r\n        }\r\n}\r\n\r\nexport default MapComponent;","import React, { Component } from 'react';\r\nimport { Map, CircleMarker, TileLayer, Tooltip, Marker, Popup } from \"react-leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\nimport {Snackbar} from \"@vkontakte/vkui\";\r\n\r\nclass MiniMapComponent extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            lat: 55.753960,\r\n            long: 37.620393,\r\n            zoom: 12,\r\n            marker: null\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.coords.lat !== 0){\r\n            this.setState({lat: this.props.coords.lat, long: this.props.coords.long, zoom: this.props.coords.zoom})\r\n        }\r\n    }\r\n\r\n    getDistanceFromLatLonInKm(lat1,lon1,lat2,lon2) {\r\n        let R = 6371; // Radius of the earth in km\r\n        let dLat = this.deg2rad(lat2-lat1);  // deg2rad below\r\n        let dLon = this.deg2rad(lon2-lon1);\r\n        let a =\r\n            Math.sin(dLat/2) * Math.sin(dLat/2) +\r\n            Math.cos(this.deg2rad(lat1)) * Math.cos(this.deg2rad(lat2)) *\r\n            Math.sin(dLon/2) * Math.sin(dLon/2)\r\n        ;\r\n        let c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\r\n        let d = R * c; // Distance in km\r\n        return d;\r\n    }\r\n\r\n    deg2rad(deg) {\r\n        return deg * (Math.PI/180)\r\n    }\r\n\r\n    addMarker = (e, marker) => {\r\n        const newMarker = e.latlng;\r\n        console.log(newMarker);\r\n        const dist = this.getDistanceFromLatLonInKm(this.state.lat, this.state.long, newMarker.lat, newMarker.lng);\r\n        console.log(dist)\r\n        if (dist < 1){\r\n            this.setState({marker: newMarker})\r\n            if (marker && marker.leafletElement) {\r\n                marker.leafletElement.openPopup()\r\n            }\r\n        } else {\r\n            this.setState({marker: null})\r\n            this.props.snackbar(<Snackbar\r\n                onClose={() => this.props.snackbar(null)}\r\n            >\r\n                Расстояние от Вас до точки более 1 километра. Нельзя ставить точки так далеко.\r\n            </Snackbar>)\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const L = require('leaflet');\r\n\r\n        const myIcon = L.icon({\r\n            iconUrl: require('./dps.png'),\r\n            iconSize: [64,55],\r\n            iconAnchor: [32, 64],\r\n            popupAnchor: null,\r\n            shadowUrl: null,\r\n            shadowSize: null,\r\n            shadowAnchor: null\r\n        });\r\n            return (\r\n                <div style={{ height: \"200px\", width: \"100%\", scroll: \"noscroll\"}}>\r\n                    <Map\r\n                        zoomControl={false}\r\n                        onClick={this.addMarker}\r\n                        style={{ height: \"200px\", width: \"100%\", position: 'absolute'}}\r\n                        zoom={this.state.zoom}\r\n                        center={[this.state.lat, this.state.long]}>\r\n                        <TileLayer url=\"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\" />\r\n                        <CircleMarker\r\n                            center={[this.props.coords.lat !== 0 ? this.props.coords.lat : this.state.lat, this.props.coords.long !==0 ? this.props.coords.long : this.state.long]}\r\n                        />\r\n                        {\r\n                            this.state.marker !== null &&\r\n                            <Marker\r\n                                icon={myIcon}\r\n                                position={this.state.marker}\r\n                            >\r\n                                <Tooltip permanent>\r\n                                    <span>Здесь</span>\r\n                                </Tooltip>\r\n                            </Marker>\r\n\r\n                        }\r\n                    </Map>\r\n                </div>\r\n            );\r\n        }\r\n}\r\n\r\nexport default MiniMapComponent;","import React, { useState, useEffect } from 'react';\r\nimport {CardGrid, Card, Group, FormLayout, Radio, Header, Button, File} from '@vkontakte/vkui';\r\nimport Icon24Add from '@vkontakte/icons/dist/24/add';\r\nimport Icon36Add from '@vkontakte/icons/dist/36/add';\r\nimport MiniMapComponent from './minimap';\r\nimport App from \"../App\";\r\nimport Icon28DeleteOutline from '@vkontakte/icons/dist/28/delete_outline';\r\n\r\nconst Add = (props) => {\r\n    const [photo1, setPhoto1] = useState(null);\r\n    const [photo2, setPhoto2] = useState(null);\r\n    const [photo3, setPhoto3] = useState(null);\r\n    function handleFileSelect(evt) {\r\n        let file = evt.target.files; // FileList object\r\n        let f = file[0];\r\n        // Only process image files.\r\n        if (!f.type.match('image.*')) {\r\n            console.log(\"Image only please....\");\r\n        }\r\n        let reader = new FileReader();\r\n        // Closure to capture the file information.\r\n        reader.onload = ((theFile) => {\r\n            return function(e) {\r\n                if (photo1 === null){\r\n                    setPhoto1('url('+e.target.result +')');\r\n                } else if (photo2 === null){\r\n                    setPhoto2('url('+e.target.result +')');\r\n                } else if (photo3 === null){\r\n                    setPhoto3('url('+e.target.result +')');\r\n                }\r\n            };\r\n        })(f);\r\n        // Read in the image file as a data URL.\r\n        reader.readAsDataURL(f);\r\n    }\r\n    return (\r\n        <React.Fragment>\r\n            <Group header={<Header mode=\"secondary\">Сделайте отметку на карте</Header>}>\r\n                <MiniMapComponent snackbar={props.snackbar} coords={props.coords} height={'400px'}/>\r\n            </Group>\r\n        <Group separator=\"hide\" header={<Header mode=\"secondary\">Добавьте фотографии</Header>}>\r\n            <CardGrid>\r\n                <Card size=\"s\" mode=\"shadow\">\r\n                    <div style={{ height: 96, backgroundPosition: 'center', backgroundSize: 'cover', backgroundImage: photo1}}>\r\n                        {\r\n                            photo1 === null &&\r\n                            <File onChange={(event)=>handleFileSelect(event)} style={{height: '100%', width: '100%', backgroundColor: \"#00ffff00\"}} top=\"\" controlSize=\"xl\">\r\n                                <Icon36Add style={{marginTop: '19px', color: \"#9ec1ea\"}}/>\r\n                            </File>\r\n                        }\r\n                    </div>\r\n                    {\r\n                        photo1 !== null &&\r\n                        <div style={{color: 'red', textAlign: 'center'}} onClick={()=>setPhoto1(null)}>Удалить</div>\r\n                    }\r\n                </Card>\r\n                <Card size=\"s\" mode=\"shadow\">\r\n                    <div style={{ height: 96, backgroundPosition: 'center', backgroundSize: 'cover', backgroundImage: photo2}}>\r\n                        {\r\n                            photo2 === null &&\r\n                            <File onChange={(event)=>handleFileSelect(event)} style={{height: '100%', width: '100%', backgroundColor: \"#00ffff00\"}} top=\"\" controlSize=\"xl\">\r\n                                <Icon36Add style={{marginTop: '19px', color: \"#9ec1ea\"}}/>\r\n                            </File>\r\n                        }\r\n                    </div>\r\n                    {\r\n                        photo2 !== null &&\r\n                        <div style={{color: 'red', textAlign: 'center'}} onClick={()=>setPhoto2(null)}>Удалить</div>\r\n                    }\r\n                </Card>\r\n                <Card size=\"s\" mode=\"shadow\">\r\n                <div style={{ height: 96, backgroundPosition: 'center', backgroundSize: 'cover', backgroundImage: photo3}}>\r\n                    {\r\n                        photo3 === null &&\r\n                        <File onChange={(event)=>handleFileSelect(event)} style={{height: '100%', width: '100%', backgroundColor: \"#00ffff00\"}} top=\"\" controlSize=\"xl\">\r\n                            <Icon36Add style={{marginTop: '19px', color: \"#9ec1ea\"}}/>\r\n                        </File>\r\n                    }\r\n                </div>\r\n                    {\r\n                        photo3 !== null &&\r\n                        <div style={{color: 'red', textAlign: 'center'}} onClick={()=>setPhoto3(null)}>Удалить</div>\r\n                    }\r\n            </Card>\r\n            </CardGrid>\r\n        </Group>\r\n            <Group header={<Header mode=\"secondary\">Укажите тип отметки</Header>}>\r\n                <FormLayout>\r\n                    <div>\r\n                        <Radio name=\"radio\" value=\"1\" description=\"Тренога\" defaultChecked>Передвижная камера</Radio>\r\n                        {/*<Radio name=\"radio\" value=\"2\" description=\"Стационарный\">Пост ДПС</Radio>*/}\r\n                        <Radio name=\"radio\" value=\"3\" description=\"Проверки и спецоперации\">Мобильная группа ДПС</Radio>\r\n                    </div>\r\n                </FormLayout>\r\n            </Group>\r\n            <Group header={<Header mode=\"secondary\">Завершите добавление</Header>}>\r\n                <Button size=\"xl\" mode=\"secondary\">Добавить на карту</Button>\r\n            </Group>\r\n        </React.Fragment>\r\n    )\r\n};\r\n\r\nexport default Add;","import {\r\n    Cell,\r\n    List,\r\n    ModalCard,\r\n    ModalRoot,\r\n    Panel,\r\n    PanelHeader,\r\n    PanelHeaderButton,\r\n    PanelHeaderContext\r\n} from \"@vkontakte/vkui\";\r\nimport Icon28ChevronDownOutline from '@vkontakte/icons/dist/28/chevron_down_outline';\r\nimport Icon24Done from '@vkontakte/icons/dist/24/done';\r\nimport MapComponent from \"../components/map\";\r\nimport React, {useState} from \"react\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\n\r\nconst PanelMap = (props) => {\r\n    const geoStatus = props.geoStatus;\r\n    const setGeoStatus = props.setGeoStatus;\r\n    const coords = props.coords;\r\n    const [filter, setFilter] = useState({zero: true,one: true,two: true,three: true,four: true});\r\n    const [support, openSupport] = useState(false);\r\n    return (\r\n        <Panel id=\"map\">\r\n            <PanelHeader\r\n                left={<PanelHeaderButton onClick={()=>openSupport(!support)}>\r\n                    <Icon28ChevronDownOutline\r\n                        style={{ transform: `rotate(${support ? '180deg' : '0'})` }}\r\n                        onClick={()=>openSupport(!support)}\r\n                    />\r\n                </PanelHeaderButton>}\r\n            >\r\n                Карта\r\n            </PanelHeader>\r\n            <PanelHeaderContext style={{zIndex: 10}} opened={support} onClose={()=>openSupport(!support)}>\r\n                <List>\r\n                    <Cell\r\n                        before={'*marker*'}\r\n                    >Вы здесь</Cell>\r\n                    {/*<Cell*/}\r\n                    {/*\tbefore={'*marker*'}*/}\r\n                    {/*\tasideContent={filter.zero === true ? <Icon24Done fill=\"var(--accent)\" /> : null}*/}\r\n                    {/*\tonClick={*/}\r\n                    {/*\t\t()=>{*/}\r\n                    {/*\t\t\tconsole.log(filter);*/}\r\n                    {/*\t\t\tfilter.zero=!filter.zero;*/}\r\n                    {/*\t\t\tsetFilter(filter);*/}\r\n                    {/*\t\t}*/}\r\n                    {/*\t}*/}\r\n                    {/*>Посты ДПС</Cell>*/}\r\n                    {/*<Cell*/}\r\n                    {/*\tbefore={'*marker*'}*/}\r\n                    {/*\tasideContent={filter.one === true ? <Icon24Done fill=\"var(--accent)\" /> : null}*/}\r\n                    {/*\tonClick={*/}\r\n                    {/*\t\t()=>{*/}\r\n                    {/*\t\t\tlet newFilter = filter;*/}\r\n                    {/*\t\t\tnewFilter.one=!filter.one;*/}\r\n                    {/*\t\t\tsetFilter(newFilter);*/}\r\n                    {/*\t\t}*/}\r\n                    {/*\t}*/}\r\n                    {/*>Стационарные камеры</Cell>*/}\r\n                    <Cell\r\n                        description={'Треноги'}\r\n                        before={'*marker*'}\r\n                        asideContent={filter.two === true ? <Icon24Done fill=\"var(--accent)\" /> : null}\r\n                        onClick={\r\n                            ()=>{\r\n                                let newFilter = filter;\r\n                                newFilter.two=!filter.two;\r\n                                setFilter(newFilter);\r\n                            }\r\n                        }\r\n                    >Передвижные камеры</Cell>\r\n                    <Cell\r\n                        description={'Дежурные экипажи'}\r\n                        before={'*marker*'}\r\n                        asideContent={filter.three === true ? <Icon24Done fill=\"var(--accent)\" /> : null}\r\n                        onClick={\r\n                            ()=>{\r\n                                let newFilter = filter;\r\n                                newFilter.three=!filter.three;\r\n                                setFilter(newFilter);\r\n                            }\r\n                        }\r\n                    >Мобильная группа ДПС</Cell>\r\n                </List>\r\n            </PanelHeaderContext>\r\n            {\r\n                geoStatus === false &&\r\n                <Cell style={{zIndex: 5}} onClick={()=>setGeoStatus(null)} multiline>Вы не дали доступ в геопозиции, для более удобной навигации нажмите сюда</Cell>\r\n            }\r\n            <MapComponent\r\n                coords={coords}\r\n                openModalCard={props.openModalCard}\r\n            />\r\n        </Panel>\r\n    )\r\n};\r\n\r\nexport default PanelMap;","import {\r\n    Avatar,\r\n    Button,\r\n    Card,\r\n    CardGrid,\r\n    Counter,\r\n    Div,\r\n    FormLayout,\r\n    RichCell,\r\n    Tabs,\r\n    TabsItem,\r\n    Textarea\r\n} from \"@vkontakte/vkui\";\r\nimport React, {useEffect, useState} from \"react\";\r\n\r\nconst MarkerInfo = (props) => {\r\n    const setModalPage = props.setModalPage;\r\n    const [activeTab, setActiveTab] = useState('info');\r\n    useEffect(()=>{\r\n        console.log(activeTab)\r\n    });\r\n    return (\r\n        <React.Fragment>\r\n            <Div>Последняя отметка:</Div>\r\n            <RichCell\r\n                before={<Avatar size={48} src={'https://sun1-19.userapi.com/icUGHkpxSwBNk4bwJSeVnoEEGC_iGmLBAryD1w/DH9wm4lg9mU.jpg'} />}\r\n                caption=\"7 минут назад\"\r\n                after=\"+1\"\r\n            >\r\n                Василий Лисовский\r\n            </RichCell>\r\n            <CardGrid>\r\n                <Card size=\"s\" mode=\"shadow\">\r\n                    <div style={{ height: 96, backgroundPosition: 'center', backgroundSize: 'cover', backgroundImage: 'url(\"https://ib.drivenn.ru/bvpysv355088z_oc1hsy.jpeg\")'}}/>\r\n                </Card>\r\n                <Card size=\"s\" mode=\"shadow\">\r\n                    <div style={{ height: 96, backgroundPosition: 'center', backgroundSize: 'cover', backgroundImage: 'url(\"https://ib.drivenn.ru/bvpysv355088z_oc1hsy.jpeg\")'}}/>\r\n                </Card><Card size=\"s\" mode=\"shadow\">\r\n                <div style={{ height: 96, backgroundPosition: 'center', backgroundSize: 'cover', backgroundImage: 'url(\"https://ib.drivenn.ru/bvpysv355088z_oc1hsy.jpeg\")'}}/>\r\n            </Card>\r\n            </CardGrid>\r\n            <Div style={{display: 'flex'}}>\r\n                <Button\r\n                    size=\"l\"\r\n                    stretched\r\n                    mode=\"primary\"\r\n                    style={{ marginRight: 8 }}\r\n                    onClick={() => {\r\n                        console.log(1);\r\n                        setModalPage(null);\r\n                    }}\r\n                    after={<Counter>0</Counter>}\r\n                >На месте</Button>\r\n                <Button\r\n                    size=\"l\"\r\n                    stretched\r\n                    mode=\"secondary\"\r\n                    onClick={() => {\r\n                        console.log(2);\r\n                        setModalPage(null);\r\n                    }}\r\n                    after={<Counter>0</Counter>}\r\n                >Уехали</Button>\r\n            </Div>\r\n        </React.Fragment>\r\n    )\r\n};\r\n\r\nexport default MarkerInfo;","import React, { useState, useEffect } from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport {\n\tView,\n\tPanel,\n\tPanelHeader,\n\tEpic,\n\tTabbar,\n\tTabbarItem,\n\tButton,\n\tDiv,\n\tList,\n\tCounter,\n\tModalRoot,\n\tModalCard, RichCell, Avatar, Card, File, CardGrid, Tabs, TabsItem, ModalPage\n} from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport Icon28Search from '@vkontakte/icons/dist/28/search';\nimport Icon28AddOutline from '@vkontakte/icons/dist/28/add_outline';\nimport MapComponent from './components/map';\nimport Add from './components/add';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport PanelMap from './panels/panelMap';\nimport MarkerInfo from './components/markerInfo';\nimport Icon24CommentOutline from '@vkontakte/icons/dist/24/comment_outline';\n\nconst App = () => {\n\tconst [geoStatus, setGeoStatus] = useState(null);\n\tif (geoStatus === null){\n\t\tbridge.send(\"VKWebAppGetGeodata\", {})\n\t\t\t.then(res=>{\n\t\t\t\tconsole.log(res);\n\t\t\t\tif (res.error_reason === 'User denied'){\n\t\t\t\t\tsetGeoStatus(false)\n\t\t\t\t} else {\n\t\t\t\t\tsetGeoStatus(true)\n\t\t\t\t\tsetCoords({lat: res.lat, long: res.long, zoom: 13})\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(e=>console.log(e));\n\t}\n\tconst [coords, setCoords] = useState({lat: 0, long: 0});\n\tconst [modalPage, setModalPage] = useState(null);\n\tconst [activeStory, setActiveStory] = useState(\"map\");\n\tconst [snackbar, setSnackbar] = useState(null);\n\tlet modalCard = (\n\t\t<ModalRoot activeModal={'marker'} style={{maxHeight: '500px', overflow: 'scroll'}}>\n\t\t\t<ModalCard\n\t\t\t\tid={'marker'}\n\t\t\t\tonClose={() => setModalPage(null)}\n\t\t\t\t//icon={<Icon56MoneyTransferOutline />}\n\t\t\t\theader=\"Мобильная группа ДПС\"\n\t\t\t\tcaption={\n\t\t\t\t\t<MarkerInfo setModalPage={setModalPage} />\n\t\t\t\t}\n\t\t\t>\n\t\t\t</ModalCard>\n\t\t</ModalRoot>\n\t);\n\t\treturn (\n\t\t\t<Epic activeStory={activeStory} tabbar={\n\t\t\t\t<Tabbar>\n\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\tonClick={()=>setActiveStory('map')}\n\t\t\t\t\t\tselected={activeStory === 'map'}\n\t\t\t\t\t\tdata-story=\"map\"\n\t\t\t\t\t\ttext=\"Карта\"\n\t\t\t\t\t><Icon28Search /></TabbarItem>\n\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\tonClick={()=>setActiveStory('add')}\n\t\t\t\t\t\tselected={activeStory === 'add'}\n\t\t\t\t\t\tdata-story=\"add\"\n\t\t\t\t\t\ttext=\"Добавить\"\n\t\t\t\t\t><Icon28AddOutline /></TabbarItem>\n\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\tonClick={()=>setActiveStory('chat')}\n\t\t\t\t\t\tselected={activeStory === 'chat'}\n\t\t\t\t\t\tdata-story=\"chat\"\n\t\t\t\t\t\ttext=\"Чатик\"\n\t\t\t\t\t><Icon24CommentOutline /></TabbarItem>\n\t\t\t\t</Tabbar>\n\t\t\t}>\n\t\t\t\t<View id=\"map\" activePanel=\"map\" modal={modalPage}>\n\t\t\t\t\t<PanelMap\n\t\t\t\t\t\tid=\"map\"\n\t\t\t\t\t\tcoords={coords}\n\t\t\t\t\t\tgeoStatus={geoStatus}\n\t\t\t\t\t\tsetGeoStatus={setGeoStatus}\n\t\t\t\t\t\topenModalCard={()=>setModalPage(modalCard)}\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t\t<View id=\"add\" activePanel=\"add\">\n\t\t\t\t\t<Panel id=\"add\">\n\t\t\t\t\t\t<PanelHeader>Добавить</PanelHeader>\n\t\t\t\t\t\t<Add coords={coords} snackbar={(content)=>setSnackbar(content)}/>\n\t\t\t\t\t\t{snackbar}\n\t\t\t\t\t</Panel>\n\t\t\t\t</View>\n\t\t\t\t<View id=\"chat\" activePanel=\"chat\">\n\t\t\t\t\t<Panel id=\"chat\">\n\t\t\t\t\t\t<PanelHeader>Чатик</PanelHeader>\n\t\t\t\t\t</Panel>\n\t\t\t\t</View>\n\t\t\t</Epic>\n\t\t);\n};\n\nexport default App;\n\n","import \"core-js/features/map\";\nimport \"core-js/features/set\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport App from \"./App\";\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\", {});\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\nif (process.env.NODE_ENV === \"development\") {\n  import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\n}\n"],"sourceRoot":""}